var selectedCategoryChild = 'all';

jQuery(document).ready(function () {
    jQuery('#category_selector button').click(function () {
        selectedCategoryChild = jQuery(this).data('category');
        // if (selectedCategoryChild == 'all') {
        //     jQuery('.cat-thumb').show();
        // } else {
        //     jQuery('.cat-thumb').hide();
        //     jQuery('.' + selectedCategoryChild + '-thumb').show();
        // }
        categorySwitch(selectedCategoryChild);
    });
    jQuery('.mt_slider').on('afterChange', function (event, slick, currentSlide, nextSlide) {
        var currentActive = jQuery('.slick-active').attr('data-category');
        if (selectedCategoryChild != 'all') {
            if (selectedCategoryChild != currentActive) {
                selectedCategoryChild = currentActive;
                categorySwitch(selectedCategoryChild);
            }
        } else {
            jQuery('ul#thumbnails li').show();
        }
        var index = jQuery('div.mt_slide.slick-active').data('slick-index');
        jQuery('ul#thumbnails li').removeClass("active");
        jQuery('ul#thumbnails li[data-slide-index="' + index + '"]').addClass("active");
    });

    jQuery('#thumbnails').on('click', '.cat-thumb', function () {
        slide = jQuery(this).attr('data-slide-index');
        jQuery('.mt_slider').slick('slickGoTo', (slide), true);
    })
    galleryBannerHeight();

    jQuery(".load-more ").click(function () {
        pagination();
    });

});

jQuery(window).load(function () {
    galleryBannerHeight();
});
jQuery(window).on('resize', function () {
    galleryBannerHeight();
});

function galleryBannerHeight() {
    var mTop = jQuery('header').outerHeight();
    jQuery('.mt_banner').css('margin-top', mTop)
}


function pagination() {
    if (jQuery('#page').length) {
        cur_page = parseInt(jQuery('#page').val());
        total_page = jQuery("#total_page").val();
        gallery_images = jQuery("#gallery_images").text();
        jQuery("#loading").show();
        var current_category = jQuery('#category_selector .selectivo__option--selected').attr('data-value');
        jQuery.ajax({
            url: site_child_theme_path + '/gallery-ajax.php',
            data: {
                page: cur_page,
                category: current_category,
                total_page: total_page,
                current_index: jQuery('#current_index').val()
            },
            dataType: 'json',
            type: 'POST',
            beforeSend: function () {
                jQuery('.load-more').hide();
                jQuery('.loading-icon').show();
            },
            success: function (response) {
                cur_page++;
                jQuery('.loading-icon').hide();
                jQuery('#page').val(cur_page);
                jQuery("#loading").hide();
                if (cur_page >= jQuery('#total_page').val()) {
                    jQuery('.load-more').hide();
                } else {
                    jQuery('.load-more').show();
                }
                jQuery('#current_index').val(response[1]);
                jQuery('#thumbnails').append(response[0]);
            }
        });
    }
}




function categorySwitch(selected_category) {
    jQuery.ajax({
        url: site_child_theme_path + '/gallery-category-ajax.php',
        data: {
            category: selected_category,
        },
        dataType: 'json',
        type: 'POST',
        beforeSend: function () {
            jQuery('.load-more').hide();
            jQuery('#thumbnails').html('');
            jQuery('.loading-icon').show();
        },
        success: function (response) {
            jQuery('#thumbnails').empty();
            jQuery('.loading-icon').hide();
            jQuery('#thumbnails').append(response[0]);
            jQuery('#current_index').val(response[1]);
            jQuery('#total_page').val(response[2]);
            if (jQuery('#total_page').val() == 1) {
                jQuery('.load-more').hide();
            } else {
                jQuery('.load-more').show();
            }
            jQuery('#page').val(1);
            var index = jQuery('div.mt_slide.slick-active').data('slick-index');
            jQuery('ul#thumbnails li').removeClass("active");
            jQuery('ul#thumbnails li[data-slide-index="' + index + '"]').addClass("active");

        }
    });
}

